{"filter":false,"title":"busquedas_controller.rb","tooltip":"/app/controllers/busquedas_controller.rb","undoManager":{"mark":20,"position":20,"stack":[[{"start":{"row":0,"column":0},"end":{"row":50,"column":3},"action":"insert","lines":["class BusquedasController < ApplicationController","    before_action :autentificar_usuario?, only: [:search, :contactos, :canales]","    before_action :get_perfil_propio, only: [:search, :contactos, :canales]","    ","    def search","        if params[:q]","            redirect_to :controller => 'busquedas', :action => 'contactos', :q => params[:q]","        else","            redirect_to :controller => 'busquedas', :action => 'canales', :cha => params[:cha]","        end","    end","    ","    def contactos()","        buscar_seguidos(session[:id])","        @perfiles = []","        response = RestClient.get(\"#{BASE_URL}/api/usuarios#{ \"?username=#{params[:q]}\" if params[:q]}\") ","        if (response.code == 200) ","            parsed = JSON.parse(response)","            parsed.each do |pars|","                ","                perfil = Perfil.new","                response = RestClient.get(\"#{BASE_URL}/api/perfils?id_usuario=#{pars['id']}\") ","                if (response.code == 200)","                    parsed = JSON.parse(response)","                    parsed.each do |parse|","                        perfil = Perfil.new(parse['id'].to_i, parse['id_usuario'].to_i, parse['username'], parse['fecha_nacimiento'], parse['telefono'], parse['titulo'], parse['ocupacion'], parse['pais'], parse['ciudad'], parse['estado'], parse['sobre_mi'], parse['id_imagen'].to_i)","                    end","                end","                ","                imagen = Imagene.new","                response = RestClient.get(\"#{BASE_URL}/api/imagenes?id=#{perfil.id_imagen}\") ","                if (response.code == 200) ","                    parsed = JSON.parse(response)","                    parsed.each do |imag|","                        imagen = Imagene.new(imag['id'].to_i, imag['nombre'], imag['data'], imag['filename'], imag['tipo'])","                    end","                end","                ","                completo = Postcompleto.new","                completo.perfil = perfil","                completo.imagen = imagen","                @perfiles << completo","            end","        end","    end","    ","    def canales","        ","    end","    ","end"],"id":1}],[{"start":{"row":8,"column":40},"end":{"row":8,"column":49},"action":"remove","lines":["busquedas"],"id":2},{"start":{"row":8,"column":40},"end":{"row":8,"column":41},"action":"insert","lines":["c"]}],[{"start":{"row":8,"column":41},"end":{"row":8,"column":42},"action":"insert","lines":["a"],"id":3}],[{"start":{"row":8,"column":42},"end":{"row":8,"column":43},"action":"insert","lines":["n"],"id":4}],[{"start":{"row":8,"column":43},"end":{"row":8,"column":44},"action":"insert","lines":["a"],"id":6}],[{"start":{"row":8,"column":44},"end":{"row":8,"column":45},"action":"insert","lines":["l"],"id":7}],[{"start":{"row":8,"column":45},"end":{"row":8,"column":46},"action":"insert","lines":["e"],"id":8}],[{"start":{"row":8,"column":46},"end":{"row":8,"column":47},"action":"insert","lines":["s"],"id":9}],[{"start":{"row":8,"column":62},"end":{"row":8,"column":69},"action":"remove","lines":["canales"],"id":10},{"start":{"row":8,"column":62},"end":{"row":8,"column":63},"action":"insert","lines":["i"]}],[{"start":{"row":8,"column":63},"end":{"row":8,"column":64},"action":"insert","lines":["n"],"id":11}],[{"start":{"row":8,"column":64},"end":{"row":8,"column":65},"action":"insert","lines":["d"],"id":12}],[{"start":{"row":8,"column":65},"end":{"row":8,"column":66},"action":"insert","lines":["e"],"id":13}],[{"start":{"row":8,"column":66},"end":{"row":8,"column":67},"action":"insert","lines":["x"],"id":14}],[{"start":{"row":5,"column":11},"end":{"row":5,"column":33},"action":"insert","lines":["(params.has_key?(:one)"],"id":17}],[{"start":{"row":5,"column":29},"end":{"row":5,"column":32},"action":"remove","lines":["one"],"id":18},{"start":{"row":5,"column":29},"end":{"row":5,"column":30},"action":"insert","lines":["1"]}],[{"start":{"row":5,"column":29},"end":{"row":5,"column":30},"action":"remove","lines":["1"],"id":19}],[{"start":{"row":5,"column":29},"end":{"row":5,"column":30},"action":"insert","lines":["q"],"id":20}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":41},"action":"remove","lines":["rams[:q]"],"id":21}],[{"start":{"row":5,"column":32},"end":{"row":5,"column":33},"action":"remove","lines":["a"],"id":22}],[{"start":{"row":5,"column":31},"end":{"row":5,"column":32},"action":"remove","lines":["p"],"id":23}],[{"start":{"row":5,"column":31},"end":{"row":5,"column":32},"action":"insert","lines":[")"],"id":24}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":5,"column":32},"end":{"row":5,"column":32},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1490666990726,"hash":"d97448a4039f8762a8e55ec832e9ce57e35f00ca"}